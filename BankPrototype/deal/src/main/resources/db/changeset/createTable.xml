<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
     <changeSet id="create_table" author="Oladushek">
         <!-- Прописываем создание таблиц-->
          <createTable tableName="credit">
             <column autoIncrement="true" name="credit_id" type="SERIAL">
                <constraints primaryKey="true" nullable="false"/>
             </column>
             <column name="amount" type="DECIMAL"/>
             <column name="term" type="INTEGER"/>
             <column name="monthly_payment" type="DECIMAL"/>
             <column name="rate" type="DECIMAL"/>
             <column name="psk" type="DECIMAL"/>
             <column name="payment_schedule" type="JSONB"/>
             <column name="insurance_enable" type="BOOLEAN"/>
             <column name="salary_client" type="BOOLEAN"/>
             <column name="credit_status" type="VARCHAR(255)"/>
         </createTable>

         <createTable tableName="application">
             <!--Создаем поля -->
             <column autoIncrement="true" name="application_id" type="SERIAL">
                 <constraints primaryKey="true" nullable="false"/>
             </column>
             <column name="client_id" type="BIGINT"/>
             <column name="credit_id" type="BIGINT"/>
             <column name="status" type="VARCHAR(255)"/>
             <column name="creation_date" type="TIMESTAMP"/>
             <column name="applied_offer" type="JSONB"/>
             <column name="sign_date" type="TIMESTAMP"/>
             <column name="ses_code" type="BIGINT"/>
             <column name="status_history" type="JSONB"/>
         </createTable>

         <createTable tableName="client">
             <!--Создаем поля -->
             <column autoIncrement="true" name="client_id" type="SERIAL">
                 <constraints primaryKey="true" nullable="false"/>
             </column>
             <column name="last_name" type="VARCHAR(255)"/>
             <column name="first_name" type="VARCHAR(255)"/>
             <column name="middle_name" type="VARCHAR(255)"/>
             <column name="birth_date" type="DATE"/>
             <column name="email" type="VARCHAR(255)"/>
             <column name="gender" type="VARCHAR(255)"/>
             <column name="marital_status" type="VARCHAR(255)"/>
             <column name="dependent_amount" type="INTEGER"/>
             <column name="passport_id" type="JSONB"/>
             <column name="employment_id" type="JSONB"/>
             <column name="account" type="VARCHAR(255)"/>
         </createTable>

         <addForeignKeyConstraint baseColumnNames="client_id"
             baseTableName="application"
             constraintName="fk_client"
             referencedColumnNames="client_id"
             referencedTableName="client"/>

         <addForeignKeyConstraint baseColumnNames="credit_id"
              baseTableName="application"
              constraintName="fk_credit"
              referencedColumnNames="credit_id"
              referencedTableName="credit"/>
     </changeSet>

</databaseChangeLog>